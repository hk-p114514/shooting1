(()=>{"use strict";var t=function(){function t(){this.x=0,this.y=0}return t.prototype.distance=function(i){var e=new t;return e.x=i.x-this.x,e.y=i.y-this.y,e},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.normalize=function(){var t=this.length();if(t>0){var i=1/t;this.x*=i,this.y*=i}},t}(),i=function(){function i(){this.position=new t,this.size=0,this.life=0,this.param=0,this.alive=!1}return i.prototype.BossSet=function(t,i,e){this.position.x=t.x,this.position.y=t.y,this.size=i,this.life=e,this.param=0,this.alive=!0},i.prototype.BossMove=function(){var t,i;switch(this.param++,!0){case this.param<100:this.position.y+=1.5;break;default:t=(this.param-100)%360*Math.PI/180,i=n.width/2,this.position.x=i+Math.sin(t)*i}},i}(),e=function(){function i(){this.position=new t,this.size=0,this.speed=15}return i.prototype.init=function(t){this.size=t},i}(),o=document.getElementById("reset"),s=document.getElementById("time"),n=document.getElementById("canvas"),h=document.getElementById("info"),r=1e3,a=500,p=new t,c=new e,l=new Array(20),f=new Array(r),x=new Array(a),y=new i,u=new Array(2),v={run:!0,fire:!1,startTime:0,isRunning:!1,timeOutId:setTimeout((function(){}),0),ctx:null,p:new t,counter:0,score:0},d={top:!1,right:!1,bottom:!1,left:!1,fire:!1},m=function(){function i(){this.position=new t,this.size=0,this.speed=0,this.alive=!1}return i.prototype.CharacterShotSet=function(t,i,e){this.position.x=t.x,this.position.y=t.y,this.size=i,this.speed=e,this.alive=!0},i.prototype.CharacterShotMove=function(){this.position.y-=this.speed,this.position.y<-this.size&&(this.alive=!1)},i}(),w=function(){function i(){this.position=new t,this.size=0,this.type=0,this.param=0,this.alive=!1}return i.prototype.EnemySet=function(t,i,e){this.position.x=t.x,this.position.y=t.y,this.size=i,this.type=e,this.param=0,this.alive=!0},i.prototype.EnemyMove=function(){switch(this.param++,this.type){case 1:this.position.x-=2,this.position.y-=2,this.position.x>n.width+this.size&&(this.alive=!1);break;case 2:this.position.x+=2,this.position.y+=2,this.position.x<-this.size&&(this.alive=!1);break;case 3:this.position.x-=2,this.position.y+=2,this.position.x>n.width+this.size&&(this.alive=!1);break;case 4:this.position.x+=2,this.position.y-=2,this.position.x<-this.size&&(this.alive=!1);break;case 5:this.position.x+=2,this.position.x>n.width+this.size&&(this.alive=!1);break;case 6:this.position.x-=2,this.position.x<-this.size&&(this.alive=!1)}},i}(),g=function(){function i(){this.position=new t,this.vector=new t,this.size=0,this.speed=0,this.alive=!1}return i.prototype.EnemyShotSet=function(t,i,e,o){this.position.x=t.x,this.position.y=t.y,this.vector.x=i.x,this.vector.y=i.y,this.size=e,this.speed=o,this.alive=!0},i.prototype.EnemyShotMove=function(){this.position.x+=this.vector.x*this.speed,this.position.y+=this.vector.y*this.speed,(this.position.x<-this.size||this.position.y<-this.size||this.position.x>this.size+n.width||this.position.y>this.size+n.height)&&(this.alive=!1)},i}(),z=function(){function i(){this.position=new t,this.parent=null,this.size=0,this.life=0,this.param=0,this.alive=!1}return i.prototype.BitSet=function(t,i,e,o){this.parent=t,this.size=i,this.life=e,this.param=o,this.alive=!0},i.prototype.BitMove=function(){var t,i,e;this.param++,t=this.param%360*Math.PI/180,this.parent&&(i=Math.cos(t)*(this.parent.size+this.size),e=Math.sin(t)*(this.parent.size+this.size),this.position.x=this.parent.position.x+i,this.position.y=this.parent.position.y+e)},i}(),b=function(){null!==s&&(s.textContent=((Date.now()-v.startTime)/1e3).toFixed(2)),v.timeOutId=setTimeout((function(){b()}))},M=function(){if(v.counter++,h&&(h.innerHTML="SCORE: "+100*v.score+" "),d.left&&p.x>7&&(p.x-=c.speed),d.right&&p.x<n.width-7&&(p.x+=c.speed),d.top&&p.y>7&&(p.y-=c.speed),d.bottom&&p.y<n.height-7&&(p.y+=c.speed),d.fire&&(v.fire=!0),c.position.x=p.x,c.position.y=p.y,v.ctx&&(v.ctx.clearRect(0,0,n.width,n.height),v.ctx.beginPath()),v.ctx&&(v.ctx.arc(c.position.x,c.position.y,c.size,0,2*Math.PI,!1),v.ctx.fillStyle="rgba(159, 84, 230, 0.562)",v.ctx.strokeStyle="black",v.ctx.stroke(),v.ctx.fill()),function(){if(v.fire){for(var t=0;t<20;t++)if(!l[t].alive){l[t].CharacterShotSet(c.position,3,7);break}v.fire=!1}}(),v.ctx){v.ctx.beginPath();for(var t=0;t<20;t++)l[t].alive&&(l[t].CharacterShotMove(),v.ctx.arc(l[t].position.x,l[t].position.y,l[t].size,0,2*Math.PI,!1),v.ctx.closePath());v.ctx.fillStyle="rgba(218, 76, 11, 0.75)",v.ctx.fill()}if(v.counter%100==0&&v.counter<2800)for(t=0;t<r;t++)if(!f[t].alive){var i=(s=Math.floor(4*Math.random())+1)%2,e=10;Math.floor(2*Math.random())+0?0===i?(v.p.x=-10,v.p.y=2===s?-10:n.height-e):(v.p.x=n.width+e,v.p.y=1===s?n.height-e:-10):s%2==0?(s=6,v.p.x=n.width+e,v.p.y=n.height/2-e):(s=5,v.p.x=-10,v.p.y=n.height/2-e),f[t].EnemySet(v.p,e,s);break}if(3e3===v.counter)for(v.p.x=n.width/2,v.p.y=-80,y.BossSet(v.p,50,60),t=0;t<2;t++){var s=180;u[t].BitSet(y,15,5,t*s)}if(v.ctx)switch(!0){case v.counter<70:v.ctx.font="bold 2em Impact",v.ctx.fillText("READY...",100,100);break;case v.counter<100:v.ctx.font="bold 2em verdana",v.ctx.fillText("GO !!",100,100);break;default:for(v.ctx.beginPath(),t=0;t<r;t++)if(v.isRunning||(v.isRunning=!0,v.startTime=Date.now(),b()),f[t].alive){if(f[t].EnemyMove(),v.ctx.arc(f[t].position.x,f[t].position.y,f[t].size,0,2*Math.PI,!1),f[t].param%30==0)for(s=0;s<a;s++)if(!x[s].alive){var m=Math.floor(14*Math.random())+0;v.p=f[t].position.distance(c.position),v.p.normalize();var w=1.9*Math.random()-1;v.p.x+=w,x[s].EnemyShotSet(f[t].position,v.p,5,m);break}v.ctx.closePath()}for(v.ctx.fillStyle="rgba(206, 18, 18, 0.63)",v.ctx.fill(),v.ctx.beginPath(),t=0;t<a;t++)x[t].alive&&(x[t].EnemyShotMove(),v.ctx.arc(x[t].position.x,x[t].position.y,x[t].size,0,2*Math.PI,!1),v.ctx.closePath());for(v.ctx.fillStyle="rgba(14, 2, 121, 0.75)",v.ctx.fill(),v.ctx.beginPath(),y.alive&&(y.BossMove(),v.ctx.arc(y.position.x,y.position.y,y.size,0,2*Math.PI,!1),v.ctx.closePath()),v.ctx.fillStyle="rgba(128, 128, 128, 0.75)",v.ctx.fill(),v.ctx.beginPath(),t=0;t<2;t++)if(u[t].alive){if(u[t].BitMove(),v.ctx.arc(u[t].position.x,u[t].position.y,u[t].size,0,2*Math.PI,!1),u[t].param%30==0)for(s=0;s<a;s++)if(!x[s].alive){m=Math.floor(5*Math.random())+1,v.p=u[t].position.distance(c.position),v.p.normalize(),x[s].EnemyShotSet(u[t].position,v.p,4,m);break}v.ctx.closePath()}for(v.ctx.fillStyle="rgba(64, 64, 64, 0.75)",v.ctx.fill(),t=0;t<20;t++)if(l[t].alive){for(s=0;s<r;s++)if(f[s].alive&&(v.p=f[s].position.distance(l[t].position),v.p.length()-7<f[s].size)){f[s].alive=!1,l[t].alive=!1,v.score++;break}for(s=0;s<2;s++)if(u[s].alive&&(v.p=u[s].position.distance(l[t].position),v.p.length()<u[s].size)){u[s].life--,l[t].alive=!1,u[s].life<0&&(u[s].alive=!1,v.score+=3);break}y.alive&&(v.p=y.position.distance(l[t].position),v.p.length()<y.size&&(y.life--,l[t].alive=!1,y.life<0&&(v.score+=10,v.run=!1,v.ctx.font="bold 2em verdana",v.ctx.fillStyle="red",v.ctx.fillText("CLEAR!!",100,100),clearTimeout(v.timeOutId),o&&(o.classList.remove("playing"),o.classList.add("reset")))))}for(t=0;t<a;t++)if(x[t].alive&&(v.p=c.position.distance(x[t].position),v.p.length()<c.size)){v.ctx.font="bold 2em verdana",v.ctx.fillStyle="red",v.ctx.fillText("GAME OVER",100,100),clearTimeout(v.timeOutId),v.run=!1,o&&(o.classList.remove("playing"),o.classList.add("reset"));break}}h&&(h.innerHTML="SCORE　:　"+100*v.score),v.run&&setTimeout(M,33.333333333333336)};n&&(v.ctx=n.getContext("2d")),v.counter=0,n.width=400,n.height=400,n.addEventListener("mousemove",(function(t){p.x=t.clientX-n.offsetLeft,p.y=t.clientY-n.offsetTop}),!0),n.addEventListener("mousedown",(function(){v.fire=!0}),!0),document.addEventListener("keydown",(function(t){var i=t.key;if("ArrowLeft"===i){if(p.x<7)return;d.left=!0}if("ArrowRight"===i&&p.x<n.width-7&&(d.right=!0),"ArrowUp"===i){if(p.y<7)return;d.top=!0}"ArrowDown"===i&&p.y<n.height-7&&(d.bottom=!0),"f"===i&&(d.fire=!0),"r"===i&&location.reload(),"Escape"===i&&(v.run=!1),t.preventDefault()}),!0),document.addEventListener("keyup",(function(t){var i=t.key;"ArrowLeft"===i&&(d.left=!1),"ArrowRight"===i&&(d.right=!1),"ArrowUp"===i&&(d.top=!1),"ArrowDown"===i&&(d.bottom=!1),"f"===i&&(d.fire=!1),t.preventDefault()}),!0),c.init(14);for(var S=0;S<20;S++)l[S]=new m;for(S=0;S<r;S++)f[S]=new w;for(S=0;S<a;S++)x[S]=new g;for(S=0;S<2;S++)u[S]=new z;p.x=n.width/2,p.y=n.height-25,M()})();